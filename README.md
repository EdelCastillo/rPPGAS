---
title: "rPPGAS: basic information"
author: "E del Castillo"
date: 'october 2025'
output: html_document
---

>rPPGAS is an R package oriented to the field of mass spectrometry and focused on image processing (MSI).
Its purpose is to generate a peak matrix from the information generated by a spectrometer in imzML format.
Specifically, it is a new peak picking algorithm that achieves two goals: high centroid accuracy and the detection of centroids that might otherwise remain hidden.

![](./deconv_4.png)

## Installation

> devtools::install_github("EdelCastillo/rPPGAS")

> Please note that is a development version and no release has been made yet. So, keep looking at this page for future updates and releases.

## Use guide


### **Step 1**.- A list is generated with the test parameters.

> For **example**:  
>params\ <-list("massResolution"=30000, "maxMassResolution"=120000, "minPixelsSupport"=5, "SNR"=1,  "SNRmethod"="estnoise_mad");

**Description of the parameters:**

```         
massResolution:     Mass resolution of the spectrometer that analyzed the sample (mz/delta_mz).
maxMassResolution:  Maximum desired resolution (mz/delta_mz). Excludes centroids that are too close to each other.
minPixelSupport:    Minimum percentage of pixels that must provide intensity information for each mass (mz).
                    That is, in the peak matrix, the relative number of pixels with non-zero intensity must be equal to or greater than this.
SNR:                Signal-to-noise ratio. Discards information based on its proximity to the estimated noise level.
noiseMethod:        Procedure used for noise estimation:
                      estnoise_diff:  Average of the absolute differences with respect to the mean value.
                      estnoise_sd:    Standard deviation of the absolute differences (Gaussian filter).
                      estnoise_mad:   Median of the absolute deviations (Gaussian filter).
```

### **Step 2**.- The peak-picking algorithm is applied and its peak matrix is obtained:

> pMatrix <-getPeakMatrix(imzML_file_path, params, initMass, finalMass)

**Description of the parameters:**   
```
imzML_file_path: Absolute path to the filename with the imzML extension.
                 The attached binary file, with the ibd extension, must be in the same directory.
         params: List of parameters given in step 1.
       initMass: Initial mass to consider.
      finalMass: Final   mass to consider.

  return a list: 
   peakMatrix: Matrix of peaks (centroids) rows = pixels, columns = intensity of each pixel.
         mass: Vector with the masses associated with each column of peakMatrix.
pixelsSupport: Vector with the number of pixels in each column with non-zero intensity.
```
